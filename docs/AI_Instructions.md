DO NOT EDIT THIS FILE

AI WORK CONTRACT — OPERATING RULES AND DOCUMENTATION DISCIPLINE

This contract defines how you (the AI) must operate while working in this repository. It does not define the project's features; it defines your conduct, workflow, documentation, and quality rules. You must follow this contract to the letter.


---

0) Authority and Order of Operations

1. Highest authority: This file.


2. Second authority: Any contract(s) found under docs/ (including subfolders).


3. If conflicts exist: Stop and record the conflict in tracking logs, then follow the most strict interpretation that preserves safety, buildability, and repository integrity.




---

1) Mandatory First Actions (every session)

Before changing any code or docs:

1. Read the entire docs/ folder contents (all Markdown/text).


2. Locate any additional AI instructions. Follow them exactly.


3. Ensure these exist (create if missing):

docs/tracking/

docs/roadmap.md (append-only; see rules below)




If you cannot read files (tool limitation), you must:

Document the limitation in the tracking log immediately,

Proceed conservatively with minimal changes,

Avoid broad refactors until the constraint is removed.



---

2) Documentation Requirements (tracking + roadmap)

2.1 docs/tracking/ session logs (required)

For every working session, create a new file:

Path: docs/tracking/YYYY-MM-DD__HHMM__short-title.md

Use local time where possible.

Never overwrite an existing tracking file.

Never delete tracking files.


Each tracking file must include the following sections (in this order):

1. Session Summary

Goals for the session (bullet list)



2. Pre-Flight Checks

Current branch / commit (if available)

Build status before changes (pass/fail/unknown)



3. Work Performed

Step-by-step actions taken (chronological)

Files touched (list)



4. Results

What is complete

What is partially complete



5. Build/Test Evidence

Commands run and outcomes

If not run, state why



6. Failures / Variations

Any errors encountered, stack traces, warnings, unexpected behavior

Any deviations from spec and why



7. Next Actions

Concrete next steps (bullet list)




2.2 docs/roadmap.md (append-only)

You must maintain a single roadmap file:

Path: docs/roadmap.md

Append-only means:

Do not rewrite history,

Do not delete or reorder old entries,

Do not "clean up" older text.


You may only add new sections at the end.


Each session must append one new entry with:

Date + time

What was done

What remains

Any blockers / risks

A short "build status" line


Recommended entry template (append at bottom):

## YYYY-MM-DD HH:MM — <short-title>

**What was done:**
- 

**What remains:**
- 

**Blockers/Risks:**
- 

**Build status:**
- 


---

3) Code Changes — Rules

3.1 Always build before committing

Run the project's build command before any commit.

If the build fails, fix it before committing.

If you cannot build (no hardware, missing deps), state this clearly in the tracking log and roadmap, then proceed cautiously.


3.2 Preserve working code

Never break a working build without explicit user permission.

Never remove features or tests without explicit user direction.


3.3 Incremental changes

Small, verifiable commits > large rewrites.

One logical change per commit when possible.


3.4 Respect existing patterns

Match the coding style, naming, and architecture patterns already in the repo.

Do not rewrite code "just to improve style" unless explicitly asked.


3.5 Comment discipline

Avoid adding obvious comments ("increment counter") unless it's truly complex logic or hardware-specific behavior.

Do add comments for non-obvious algorithms, workarounds, or ESP32/hardware quirks.



---

4) Testing and Validation

If tests exist: Run them before committing.

If tests do not exist: Manually verify the change where possible (e.g., build, upload, serial output check).

State what testing was or was not done in the tracking log.


---

5) Commit Messages and Git Discipline

Commit message format:

<type>: <short summary>

<optional detailed body>


Types: feat, fix, docs, refactor, test, chore, build

Example:

feat: add I2C temperature sensor driver

- Implements DS18B20 interface
- Adds sensor read function to core HAL
- Tested on ESP32-DevKitC


Never force-push.

Never rewrite published history.

Always work in a feature branch if the repo uses that workflow.


---

6) When You Cannot Comply

If you cannot follow any rule due to:

Technical limitation (e.g., cannot run hardware tests),

Missing information (e.g., unclear user requirement),

Conflicting instructions,


Then:

1. Document the issue in the tracking log immediately.


2. State your assumption or fallback approach.


3. Proceed conservatively (smallest possible change).


4. Flag it in the roadmap under "Blockers/Risks."




---

7) Communication with User

Be direct and factual.

If something is broken, say so.

If you made an assumption, state it.

If the request is unclear, ask for clarification before making changes.


---

END OF CONTRACT

This file is the source of truth. If another document contradicts this one, this one wins.
